Thu Feb 22 13:07:52 CET 2024
Running injection number: 14
------------------------------------------------
Arguments script:
outdir: /scratch-local/twouters2.5325561
load_existing_config: True
N: 14
SNR_threshold: 12
waveform_approximant: TaylorF2
relative_binning_binsize: 500
relative_binning_ref_params_equal_true_params: True
save_training_chains: False
eps_mass_matrix: 5e-06
smart_initial_guess: False
use_scheduler: True
stopping_criterion_global_acc: 0.2
n_loop_training: 400
n_loop_production: 50
n_local_steps_training: 50
n_global_steps_training: 400
n_local_steps_production: 2
n_global_steps_production: 400
n_epochs: 50
n_chains: 1000
learning_rate: 0.001
max_samples: 50000
momentum: 0.9
batch_size: 50000
use_global: True
logging: True
keep_quantile: 0.0
local_autotune: None
train_thinning: 10
output_thinning: 30
n_sample_max: 10000
precompile: False
verbose: False
num_layers: 10
hidden_size: [128, 128]
num_bins: 8
which_local_sampler: MALA
------------------------------------------------
Starting main code
Using polynomial learning rate scheduler
Saving output to /scratch-local/twouters2.5325561
The SNR threshold parameter is set to 12
Loading existing config, path: /scratch-local/twouters2.5325561/injection_14/config.json
Injecting signals . . .
The injected parameters are {'M_c': 1.9568677619484602, 'eta': 0.24893417710751992, 's1_z': 0.009735110398633173, 's2_z': 0.048980590878307986, 'lambda_1': 1064.683599128085, 'lambda_2': 3723.7220879878337, 'd_L': 126.18218167071768, 't_c': -0.023603896693900103, 'phase_c': 3.238585218011449, 'iota': 2.640861949418257, 'psi': 0.5161579022094159, 'ra': 5.978101120559757, 'dec': -0.01944744929956209}
Signal injected
H1 SNR: 20.470170146862063
L1 SNR: 16.40007825874363
V1 SNR: 20.569589832824963
Network SNR: 33.333143545502196
Saving network SNR
Saving injected signal as Numpy arrays for H1
Saving injected signal as Numpy arrays for L1
Saving injected signal as Numpy arrays for V1
Start prior setup
Saving prior bounds
Finished prior setup
Initializing likelihood
Using the true parameters as reference parameters for the relative binning
Initializing heterodyned likelihood..
Finding reference parameters..
Using provided reference parameters
Constructing reference waveforms..
Using MALA as the local sampler
No autotune found, use input sampler_params
Training normalizing flow
Tuning global sampler:   0%|          | 0/400 [00:00<?, ?it/s]Tuning global sampler:   0%|          | 1/400 [02:51<18:58:23, 171.19s/it]Tuning global sampler:   0%|          | 2/400 [02:57<8:13:18, 74.37s/it]  Tuning global sampler:   1%|          | 3/400 [03:04<4:46:25, 43.29s/it]Tuning global sampler:   1%|          | 4/400 [03:10<3:09:26, 28.70s/it]Tuning global sampler:   1%|▏         | 5/400 [03:16<2:15:53, 20.64s/it]Tuning global sampler:   2%|▏         | 6/400 [03:23<1:43:35, 15.78s/it]Tuning global sampler:   2%|▏         | 7/400 [03:29<1:23:05, 12.69s/it]Tuning global sampler:   2%|▏         | 8/400 [03:35<1:09:26, 10.63s/it]Tuning global sampler:   2%|▏         | 9/400 [03:42<1:01:13,  9.39s/it]Tuning global sampler:   2%|▎         | 10/400 [03:48<54:50,  8.44s/it] Tuning global sampler:   3%|▎         | 11/400 [03:54<50:24,  7.77s/it]Tuning global sampler:   3%|▎         | 12/400 [04:01<47:18,  7.32s/it]Tuning global sampler:   3%|▎         | 13/400 [04:07<45:10,  7.00s/it]Tuning global sampler:   4%|▎         | 14/400 [04:13<43:45,  6.80s/it]Tuning global sampler:   4%|▍         | 15/400 [04:20<43:39,  6.81s/it]Tuning global sampler:   4%|▍         | 16/400 [04:26<42:34,  6.65s/it]Tuning global sampler:   4%|▍         | 17/400 [04:33<41:41,  6.53s/it]Tuning global sampler:   4%|▍         | 18/400 [04:39<41:07,  6.46s/it]Tuning global sampler:   5%|▍         | 19/400 [04:45<40:46,  6.42s/it]Tuning global sampler:   5%|▌         | 20/400 [04:52<40:32,  6.40s/it]Tuning global sampler:   5%|▌         | 21/400 [04:58<40:21,  6.39s/it]Tuning global sampler:   6%|▌         | 22/400 [05:04<40:09,  6.37s/it]Tuning global sampler:   6%|▌         | 23/400 [05:11<40:52,  6.51s/it]Tuning global sampler:   6%|▌         | 24/400 [05:17<40:22,  6.44s/it]Tuning global sampler:   6%|▋         | 25/400 [05:24<40:00,  6.40s/it]Tuning global sampler:   6%|▋         | 26/400 [05:30<39:48,  6.39s/it]Tuning global sampler:   7%|▋         | 27/400 [05:36<39:43,  6.39s/it]Tuning global sampler:   7%|▋         | 28/400 [05:43<39:31,  6.37s/it]Tuning global sampler:   7%|▋         | 29/400 [05:49<39:24,  6.37s/it]Tuning global sampler:   8%|▊         | 30/400 [05:56<40:16,  6.53s/it]Tuning global sampler:   8%|▊         | 31/400 [06:02<39:53,  6.49s/it]Tuning global sampler:   8%|▊         | 32/400 [06:09<39:05,  6.37s/it]Tuning global sampler:   8%|▊         | 33/400 [06:15<38:37,  6.31s/it]Tuning global sampler:   8%|▊         | 34/400 [06:21<38:18,  6.28s/it]Tuning global sampler:   9%|▉         | 35/400 [06:27<38:05,  6.26s/it]Tuning global sampler:   9%|▉         | 36/400 [06:33<37:52,  6.24s/it]Tuning global sampler:   9%|▉         | 37/400 [06:40<38:41,  6.40s/it]Tuning global sampler:  10%|▉         | 38/400 [06:46<38:14,  6.34s/it]Tuning global sampler:  10%|▉         | 39/400 [06:53<37:56,  6.31s/it]Tuning global sampler:  10%|█         | 40/400 [06:59<37:33,  6.26s/it]Tuning global sampler:  10%|█         | 41/400 [07:05<37:17,  6.23s/it]Tuning global sampler:  10%|█         | 42/400 [07:11<37:10,  6.23s/it]Tuning global sampler:  11%|█         | 43/400 [07:17<37:03,  6.23s/it]Tuning global sampler:  11%|█         | 44/400 [07:24<37:47,  6.37s/it]Tuning global sampler:  11%|█▏        | 45/400 [07:30<37:25,  6.33s/it]Tuning global sampler:  12%|█▏        | 46/400 [07:36<37:06,  6.29s/it]Tuning global sampler:  12%|█▏        | 47/400 [07:43<36:53,  6.27s/it]Tuning global sampler:  12%|█▏        | 48/400 [07:49<36:37,  6.24s/it]Tuning global sampler:  12%|█▏        | 49/400 [07:55<36:25,  6.23s/it]Tuning global sampler:  12%|█▎        | 50/400 [08:01<36:17,  6.22s/it]Tuning global sampler:  13%|█▎        | 51/400 [08:07<36:10,  6.22s/it]Tuning global sampler:  13%|█▎        | 52/400 [08:14<36:56,  6.37s/it]Tuning global sampler:  13%|█▎        | 53/400 [08:20<36:32,  6.32s/it]Tuning global sampler:  14%|█▎        | 54/400 [08:27<36:18,  6.30s/it]Tuning global sampler:  14%|█▍        | 55/400 [08:33<36:03,  6.27s/it]Tuning global sampler:  14%|█▍        | 56/400 [08:39<35:45,  6.24s/it]Tuning global sampler:  14%|█▍        | 57/400 [08:45<35:31,  6.21s/it]Tuning global sampler:  14%|█▍        | 58/400 [08:51<35:25,  6.22s/it]Tuning global sampler:  15%|█▍        | 59/400 [08:58<35:18,  6.21s/it]Tuning global sampler:  15%|█▌        | 60/400 [09:04<36:04,  6.37s/it]Tuning global sampler:  15%|█▌        | 61/400 [09:11<35:41,  6.32s/it]Tuning global sampler:  16%|█▌        | 62/400 [09:17<35:26,  6.29s/it]Tuning global sampler:  16%|█▌        | 63/400 [09:23<35:11,  6.27s/it]Tuning global sampler:  16%|█▌        | 64/400 [09:29<34:53,  6.23s/it]Tuning global sampler:  16%|█▋        | 65/400 [09:35<34:43,  6.22s/it]Tuning global sampler:  16%|█▋        | 66/400 [09:42<34:37,  6.22s/it]Tuning global sampler:  17%|█▋        | 67/400 [09:48<34:29,  6.22s/it]Tuning global sampler:  17%|█▋        | 68/400 [09:54<35:12,  6.36s/it]Tuning global sampler:  17%|█▋        | 69/400 [10:01<34:51,  6.32s/it]Tuning global sampler:  18%|█▊        | 70/400 [10:07<34:35,  6.29s/it]Tuning global sampler:  18%|█▊        | 71/400 [10:13<34:20,  6.26s/it]Tuning global sampler:  18%|█▊        | 72/400 [10:19<34:04,  6.23s/it]Tuning global sampler:  18%|█▊        | 73/400 [10:25<33:50,  6.21s/it]Tuning global sampler:  18%|█▊        | 74/400 [10:32<33:45,  6.21s/it]Tuning global sampler:  19%|█▉        | 75/400 [10:38<33:38,  6.21s/it]Tuning global sampler:  19%|█▉        | 76/400 [10:45<34:25,  6.37s/it]Tuning global sampler:  19%|█▉        | 77/400 [10:51<34:04,  6.33s/it]Tuning global sampler:  20%|█▉        | 78/400 [10:57<33:47,  6.30s/it]Tuning global sampler:  20%|█▉        | 79/400 [11:03<33:33,  6.27s/it]Tuning global sampler:  20%|██        | 80/400 [11:09<33:16,  6.24s/it]Tuning global sampler:  20%|██        | 81/400 [11:16<33:05,  6.22s/it]Tuning global sampler:  20%|██        | 82/400 [11:22<33:00,  6.23s/it]Tuning global sampler:  21%|██        | 83/400 [11:28<32:52,  6.22s/it]Tuning global sampler:  21%|██        | 84/400 [11:35<33:37,  6.38s/it]Tuning global sampler:  21%|██▏       | 85/400 [11:41<33:13,  6.33s/it]Tuning global sampler:  22%|██▏       | 86/400 [11:47<32:56,  6.30s/it]Tuning global sampler:  22%|██▏       | 87/400 [11:53<32:42,  6.27s/it]Tuning global sampler:  22%|██▏       | 88/400 [12:00<32:25,  6.24s/it]Tuning global sampler:  22%|██▏       | 89/400 [12:06<32:13,  6.22s/it]Tuning global sampler:  22%|██▎       | 90/400 [12:12<32:07,  6.22s/it]Tuning global sampler:  23%|██▎       | 91/400 [12:18<31:59,  6.21s/it]Tuning global sampler:  23%|██▎       | 92/400 [12:25<32:44,  6.38s/it]Tuning global sampler:  23%|██▎       | 92/400 [12:31<41:56,  8.17s/it]
Compiling MALA body
Early stopping: global acceptance target rate achieved
Starting Production run
Production run:   0%|          | 0/50 [00:00<?, ?it/s]Production run:   2%|▏         | 1/50 [00:39<32:00, 39.20s/it]Production run:   4%|▍         | 2/50 [00:41<13:50, 17.30s/it]Production run:   6%|▌         | 3/50 [00:43<08:03, 10.28s/it]Production run:   8%|▊         | 4/50 [00:45<05:21,  6.98s/it]Production run:  10%|█         | 5/50 [00:46<03:52,  5.17s/it]Production run:  12%|█▏        | 6/50 [00:48<02:59,  4.07s/it]Production run:  14%|█▍        | 7/50 [00:50<02:24,  3.37s/it]Production run:  16%|█▌        | 8/50 [00:52<02:02,  2.92s/it]Production run:  18%|█▊        | 9/50 [00:54<01:47,  2.61s/it]Production run:  20%|██        | 10/50 [00:56<01:36,  2.41s/it]Production run:  22%|██▏       | 11/50 [00:58<01:28,  2.28s/it]Production run:  24%|██▍       | 12/50 [01:00<01:22,  2.18s/it]Production run:  26%|██▌       | 13/50 [01:02<01:18,  2.12s/it]Production run:  28%|██▊       | 14/50 [01:04<01:14,  2.06s/it]Production run:  30%|███       | 15/50 [01:06<01:11,  2.03s/it]Production run:  32%|███▏      | 16/50 [01:08<01:06,  1.96s/it]Production run:  34%|███▍      | 17/50 [01:10<01:04,  1.97s/it]Production run:  36%|███▌      | 18/50 [01:12<01:02,  1.97s/it]Production run:  38%|███▊      | 19/50 [01:14<01:01,  1.97s/it]Production run:  40%|████      | 20/50 [01:16<00:59,  1.97s/it]Production run:  42%|████▏     | 21/50 [01:18<00:57,  1.98s/it]Production run:  44%|████▍     | 22/50 [01:20<00:55,  1.98s/it]Production run:  46%|████▌     | 23/50 [01:22<00:53,  1.98s/it]Production run:  48%|████▊     | 24/50 [01:24<00:51,  1.98s/it]Production run:  50%|█████     | 25/50 [01:26<00:49,  1.98s/it]Production run:  52%|█████▏    | 26/50 [01:28<00:47,  1.98s/it]Production run:  54%|█████▍    | 27/50 [01:30<00:45,  1.98s/it]Production run:  56%|█████▌    | 28/50 [01:31<00:43,  1.96s/it]Production run:  58%|█████▊    | 29/50 [01:33<00:41,  1.97s/it]Production run:  60%|██████    | 30/50 [01:35<00:39,  1.97s/it]Production run:  62%|██████▏   | 31/50 [01:37<00:37,  1.96s/it]Production run:  64%|██████▍   | 32/50 [01:39<00:34,  1.92s/it]Production run:  66%|██████▌   | 33/50 [01:41<00:33,  1.94s/it]Production run:  68%|██████▊   | 34/50 [01:43<00:31,  1.95s/it]Production run:  70%|███████   | 35/50 [01:45<00:29,  1.96s/it]Production run:  72%|███████▏  | 36/50 [01:47<00:27,  1.97s/it]Production run:  74%|███████▍  | 37/50 [01:49<00:25,  1.97s/it]Production run:  76%|███████▌  | 38/50 [01:51<00:23,  1.97s/it]Production run:  78%|███████▊  | 39/50 [01:53<00:21,  1.97s/it]Production run:  80%|████████  | 40/50 [01:55<00:19,  1.98s/it]Production run:  82%|████████▏ | 41/50 [01:57<00:17,  1.98s/it]Production run:  84%|████████▍ | 42/50 [01:59<00:15,  1.97s/it]Production run:  86%|████████▌ | 43/50 [02:01<00:13,  1.97s/it]Production run:  88%|████████▊ | 44/50 [02:03<00:11,  1.98s/it]Production run:  90%|█████████ | 45/50 [02:05<00:09,  1.98s/it]Production run:  92%|█████████▏| 46/50 [02:07<00:07,  1.96s/it]Production run:  94%|█████████▍| 47/50 [02:09<00:05,  1.97s/it]Production run:  96%|█████████▌| 48/50 [02:11<00:03,  1.93s/it]Production run:  98%|█████████▊| 49/50 [02:13<00:01,  1.94s/it]Production run: 100%|██████████| 50/50 [02:15<00:00,  1.95s/it]Production run: 100%|██████████| 50/50 [02:15<00:00,  2.70s/it]
Training summary
==========
M_c: 1.929 +/- 0.151
eta: 0.246 +/- 0.006
s1_z: 0.025 +/- 0.023
s2_z: 0.015 +/- 0.025
lambda_1: 2178.986 +/- 1088.448
lambda_2: 2005.699 +/- 1307.970
d_L: 168.402 +/- 62.300
t_c: -0.023 +/- 0.017
phase_c: 2.537 +/- 1.729
iota: 2.301 +/- 0.506
psi: 1.451 +/- 0.774
ra: 5.554 +/- 1.212
dec: -0.053 +/- 0.313
Log probability: 356.239 +/- 212.600
Local acceptance: 0.935 +/- 0.247
Global acceptance: 0.028 +/- 0.165
Max loss: 22.815, Min loss: 5.020
Production summary
==========
M_c: 1.957 +/- 0.000
eta: 0.249 +/- 0.002
s1_z: 0.033 +/- 0.012
s2_z: 0.031 +/- 0.013
lambda_1: 1945.444 +/- 1016.106
lambda_2: 2422.087 +/- 1408.786
d_L: 104.331 +/- 20.600
t_c: -0.023 +/- 0.001
phase_c: 3.319 +/- 1.759
iota: 2.373 +/- 0.260
psi: 1.924 +/- 0.888
ra: 5.979 +/- 0.006
dec: -0.016 +/- 0.025
Log probability: 527.176 +/- 2.418
Local acceptance: 0.885 +/- 0.319
Global acceptance: 0.201 +/- 0.401
Saving samples to /scratch-local/twouters2.5325561/injection_14/results_training.npz
Saving the NF
Saving the jim hyperparameters
Time taken: 1071.660463809967 seconds (17.86100773016612 minutes)
Saving runtime
Finished injection recovery successfully!
Copying to: /home/twouters2/jim_injections/tidal/redo_slurm/injection_14MALA_50
Directory already exists: /home/twouters2/jim_injections/tidal/redo_slurm/injection_14MALA_50
Finally, moving the output files
DONE
